# GitHub Package URL Builder Action

This action builds a GitHub package page URL with a specific tag.

> - Currently aims only for `'container'` typed packages though there are many others. (Not aware if it would also work for other types.)
> - Directly utilizes [GitHub API (v2022-11-28)](https://docs.github.com/ko/rest/packages/packages?apiVersion=2022-11-28#list-packages-for-an-organization)

## Motivations

- When you release your products as GitHub packages in a regular & frequent basis, you may have found cumbersome to make release notes everytime.
- GitHub releases are, of course, often generated by GitHub actions, but the core link between the release note and the GitHub package (e.g. GHCR) URL is often missing.
- To build the package URL, you might have tried building the URL by yourselves in:
  - Giving up automation and edit release note subsequently
    - After the (half-way) action done, you might have to edit the (action-generated) release note manually.
    - (Access github packages page)
    - (Find and copy the tag of interest)
    - (Paste the tag-specific link to the release note)
    - (Sigh ðŸ˜Œ)
  - Manual assembly: `https://github.com/{org-name}/pkgs/container/{package-name}/{id}?tag={tag-name}`
    - You never know what `{id}` is.. :(
    - (Failed)
  - Using GitHub API
    - Query via [endpoint](https://docs.github.com/ko/rest/packages/packages?apiVersion=2022-11-28#list-packages-for-an-organization)
    - Parse the response to find the tag of interest
    - Build the URL using the missing `{id}`
    - Which is.. a bit of chore still
- This is where `github-package-url-builder` kicks in. It will be saving your efforts.

## Features

- Finds a specific package version by tag
- Constructs URL with tag parameter
- Optional xfailure when tag isn't found

## Usage

```yaml
steps:
  - name: Get Package URL
    uses: hjoonjang/package-url-builder@v1
    with:
      org: <your-org>
      package: <your-package>
      tag: <your-tag>
      fail-if-not-found: true  # optional
    env:
      GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
```

## Inputs

| Input | Description | Required | Default |
|-------|-------------|----------|---------|
| `org` | GitHub organization name | Yes | - |
| `package` | Package name | Yes | - |
| `tag` | Specific tag to search for | Yes | - |
| `fail-if-not-found` | Fail workflow if tag not found | No | true |
| `github-token` | GitHub token for API auth | No | ${{ github.token }} |

## Outputs

| Output | Description |
|--------|-------------|
| `package-url` | The constructed package URL with tag |
| `version-id` | The version ID of the found package |
| `created-at` | Creation timestamp of the package version |
| `found` | Boolean indicating if tag was found |

## Example

```yaml
env:
  ORG_NAME: org-name
  TAG_NAME: tag-name
  PACKAGE_NAME: my-awesome-package

jobs:
  get-url:
    runs-on: ubuntu-latest
    steps:
      - name: Build & Push
        run: |
          docker build -t ghcr.io/${ORG_NAME}/${PACKAGE_NAME}:${TAG_NAME} . && \
          docker push ghcr.io/${ORG_NAME}/${PACKAGE_NAME}:${TAG_NAME}

      - name: Get GitHub Package URL
        id: url-builder
        uses: hjoonjang/github-package-url-builder@v1
        with:
          org: ${{ env.ORG_NAME }}
          package: ${PACKAGE_NAME}
          tag: ${{ env.TAG_NAME }}

      - name: Use URL on release note or somewhere else
        if: steps.url-builder.outputs.found == 'true'
        run: |
          echo "URL: ${{ steps.url-builder.outputs.package-url }}" >> release-note.md
```

## License

MIT License
